---
import { UserCog, LogOut } from "@lucide/astro";
import Breadcrumbs from "@/components/Breadcrumbs.astro";

const email = "johndoe@jeratpapua.org";
const fullName = "John Doe";
---

<nav
  class="sticky top-0 z-10 flex items-center justify-between border-b border-gray-200 bg-white px-4 py-2"
  aria-label="top navigation bar"
>
  <div class="flex items-center gap-x-4">
    <!-- Sidebar Toggle (Mobile) -->
    <button
      type="button"
      class="inline-block text-gray-600 md:hidden"
      x-on:click="sidebarIsOpen = true"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 16 16"
        fill="currentColor"
        class="size-5"
        aria-hidden="true"
      >
        <path
          d="M0 3a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm5-1v12h9a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1zM4 2H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h2z"
        ></path>
      </svg>
      <span class="sr-only">sidebar toggle</span>
    </button>

    <Breadcrumbs />
  </div>

  <!-- Profile Dropdown -->
  <div
    x-data="{ userDropdownIsOpen: false }"
    class="relative"
    x-on:keydown.esc.window="userDropdownIsOpen = false"
  >
    <button
      type="button"
      class="flex w-full cursor-pointer items-center gap-2 rounded-sm p-2 text-left text-gray-600 hover:bg-black/5 hover:text-gray-900 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-black"
      x-bind:class="userDropdownIsOpen ? 'bg-black/10' : ''"
      aria-haspopup="true"
      x-on:click="userDropdownIsOpen = !userDropdownIsOpen"
      x-bind:aria-expanded="userDropdownIsOpen"
    >
      <img
        class="size-8 rounded-sm object-cover"
        src={`https://ui-avatars.com/api/?name=${encodeURIComponent(fullName)}`}
        alt={fullName || email}
      />
      <div class="hidden flex-col md:flex">
        <span class="text-sm font-bold text-gray-900">{fullName}</span>
        <span class="text-xs" aria-hidden="true">{email}</span>
      </div>
    </button>

    <div
      x-cloak
      x-show="userDropdownIsOpen"
      class="absolute right-0 top-14 z-20 h-fit w-48 divide-y divide-gray-300 rounded-sm border border-gray-300 bg-white"
      role="menu"
      x-on:click.outside="userDropdownIsOpen = false"
      x-on:keydown.down.prevent="$focus.wrap().next()"
      x-on:keydown.up.prevent="$focus.wrap().previous()"
      x-transition
      x-trap="userDropdownIsOpen"
    >
      <div class="flex flex-col py-1.5">
        <a
          href="/pages/settings"
          class="flex items-center gap-x-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 focus:bg-gray-100 focus:outline-hidden disabled:pointer-events-none disabled:opacity-50"
        >
          <UserCog class="size-4 shrink-0" />
          Account Settings
        </a>
      </div>
      <div class="flex flex-col py-1.5">
        <a
          href="/auth/login"
          class="flex w-full cursor-pointer items-center gap-x-3 px-3 py-2 text-left text-sm text-gray-600 hover:bg-gray-100 focus:bg-gray-100 focus:outline-hidden disabled:pointer-events-none disabled:opacity-50"
        >
          <LogOut class="size-4 shrink-0" />
          Logout
        </a>
      </div>
    </div>
  </div>
</nav>
